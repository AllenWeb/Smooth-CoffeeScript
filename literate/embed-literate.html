<div id="feature-detect">
  <div id="feature-javascript" style="color:#FF0000; display: block">
No JavaScript &rarr; no output and no interactivity.  </div>
  <div id="feature-mathml" style="color:#FF0000; display: none">
No MathML 1998 &rarr; math is not readable.  </div>
  <div id="feature-canvas" style="color:#FF0000; display: none">
No Canvas &rarr; graphical output is not rendered.  </div>
  <div id="feature-contenteditable" style="color:#FF0000; display: none">
No ContentEditable &rarr; CoffeeScript sections can not be changed.  </div>
</div>
<input class="field" type="button" value="Adjust layout" onclick="(function () {
        return this.value = toggleLayout() ? 'Layout: fixed' : 'Layout: freeflow';
      }).call(this);" />
<input class="field" type="button" value="Switch editor" onclick="(function () {
        return this.value = switchEditor() ? 'Editor: CodeMirror' : 'Editor: plain text';
      }).call(this);" />
<script src="node_modules/coffee-script.js"></script>
<script src="node_modules/coffeekup.js"></script>
<script src="node_modules/underscore.js"></script>
<script src="node_modules/underscore.string.js"></script>
<script src="node_modules/qc.js"></script>
<script src="codemirror/codemirror.js"></script>
<script src="codemirror/coffeescript.js"></script>
<link rel="stylesheet" href="codemirror/codemirror.css" />
<link rel="stylesheet" href="codemirror/pantheme.css" />
<script>var __slice = Array.prototype.slice;var __hasProp = Object.prototype.hasOwnProperty;var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };var __extends = function(child, parent) {  for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; }  function ctor() { this.constructor = child; }  ctor.prototype = parent.prototype; child.prototype = new ctor; child.__super__ = parent.prototype;  return child; };var __indexOf = Array.prototype.indexOf || function(item) {  for (var i = 0, l = this.length; i < l; i++) {    if (this[i] === item) return i;  } return -1; };(function () {
      var featureDetect, switchLayout;
      this.reveal = function(parent) {
        return parent.getElementsByTagName('code')[0].style.display = 'block';
      };
      this.switchEditor = function() {
        if (typeof localStorage !== "undefined" && localStorage !== null) {
          localStorage.editor = this.useCodeMirror ? 'TextArea' : 'CodeMirror';
        }
        return this.useCodeMirror = !this.useCodeMirror;
      };
      this.toggleLayout = function() {
        var fixedLayout;
        fixedLayout = document.getElementById('page').style.maxWidth === '';
        if (typeof localStorage !== "undefined" && localStorage !== null) {
          localStorage.fixedLayout = fixedLayout;
        }
        return switchLayout(fixedLayout);
      };
      switchLayout = function(fixedLayout) {
        var s;
        document.getElementById('page').style.maxWidth = fixedLayout ? '600px' : '';
        s = document.getElementById('page').style;
        if (fixedLayout) {
          s.webkitHyphens = 'auto';
          s.mozHyphens = 'auto';
          s.msHyphens = 'auto';
          s.hyphens = 'auto';
          s.textAlign = 'justify';
        } else {
          s.webkitHyphens = '';
          s.mozHyphens = '';
          s.msHyphens = '';
          s.hyphens = '';
          s.textAlign = '';
        }
        return fixedLayout;
      };
      featureDetect = function() {
        var mathmlDetect, used, _ref, _ref2, _ref3, _ref4, _ref5;
        mathmlDetect = function() {
          var e, passed;
          (e = document.createElement('div')).innerHTML = '<math></math>';
          passed = e.firstChild && 'namespaceURI' in e.firstChild && e.firstChild.namespaceURI === 'http://www.w3.org/1998/Math/MathML';
          return passed && !/Chrome/.test(navigator.userAgent);
        };
        if ((_ref = document.getElementById('feature-javascript')) != null) {
          _ref.style.display = "none";
        }
        used = ((_ref2 = document.getElementsByTagName('math')) != null ? _ref2.length : void 0) > 0;
        if (used && mathmlDetect() === false) {
          if ((_ref3 = document.getElementById('feature-mathml')) != null) {
            _ref3.style.display = "block";
          }
        }
        if (document.createElement('canvas').getContext == null) {
          if ((_ref4 = document.getElementById('feature-canvas')) != null) {
            _ref4.style.display = "block";
          }
        }
        if (!('isContentEditable' in document.documentElement)) {
          return (_ref5 = document.getElementById('feature-contenteditable')) != null ? _ref5.style.display = "block" : void 0;
        }
      };
      window.onload = function() {
        var activateEditor, canvas, cmEvaluation, createEditor, evaluateSource, getParent, keyEvaluation, segment, _i, _len, _ref;
        featureDetect();
        if ((typeof localStorage !== "undefined" && localStorage !== null ? localStorage.fixedLayout : void 0) !== 'false') {
          switchLayout(true);
        }
        this.useCodeMirror = (typeof localStorage !== "undefined" && localStorage !== null ? localStorage.editor : void 0) === 'CodeMirror';
        canvas = document.getElementById('drawCanvas');
        if (canvas != null) window.ctx = canvas.getContext('2d');
        getParent = function(child) {
          var _ref;
          return (_ref = child != null ? child.parentElement : void 0) != null ? _ref : child != null ? child.parentNode : void 0;
        };
        evaluateSource = function() {
          var HtmlListener, addElement, addErrorElement, addFrame, code, codeSegment, codeTag, draw, elem, i, incredibleindex, qcConfig, segment, segments, separator, show, showDocument, test, testPure, _len, _ref;
          if (window.ctx != null) {
            window.ctx.clearRect(0, 0, window.ctx.canvas.width, window.ctx.canvas.height);
          }
          elem = window.document.getElementsByClassName('output')[0];
          while (elem != null) {
            getParent(elem).removeChild(elem);
            elem = window.document.getElementsByClassName('output')[0];
          }
          addElement = function(parent, text) {
            var newelem;
            newelem = document.createElement('code');
            newelem.setAttribute('class', 'sourceCode output');
            newelem.innerHTML = text;
            return parent.appendChild(newelem);
          };
          separator = function(parent) {
            if (parent.getElementsByClassName('output').length === 0) {
              return addElement(parent, '<hr><br>');
            }
          };
          addErrorElement = function(text) {
            var parentTag;
            parentTag = getParent(codeTag);
            separator(parentTag);
            return addElement(parentTag, "<span class=\"er\">" + text + "</span>");
          };
          show = function(msg) {
            var parentTag;
            parentTag = getParent(codeTag);
            separator(parentTag);
            addElement(parentTag, "&rarr; " + msg + "<br>");
            return msg;
          };
          addFrame = function(parent, width, height, content) {
            var newelem;
            newelem = document.createElement('iframe');
            newelem.setAttribute('class', 'output');
            newelem.setAttribute('width', width);
            newelem.setAttribute('height', height);
            newelem.setAttribute('src', "data:text/html;charset=utf-8," + (encodeURIComponent(content)));
            newelem.innerHTML = '<div id="feature-dataurl" style="color:#FF0000; display: block">\nNo or insufficient Data URL support &rarr;\nweb page output is not rendered in this browser.</div>';
            return parent.appendChild(newelem);
          };
          showDocument = function(content, width, height) {
            var parentTag;
            if (width == null) width = 300;
            if (height == null) height = 300;
            parentTag = getParent(codeTag);
            separator(parentTag);
            return addFrame(parentTag, width, height, content);
          };
          HtmlListener = (function(_super) {

            __extends(HtmlListener, _super);

            function HtmlListener(maxCollected) {
              this.maxCollected = maxCollected != null ? maxCollected : 10;
            }

            HtmlListener.prototype.log = function(str) {
              return show(str);
            };

            HtmlListener.prototype.passed = function(str) {
              return show("<span class=\"kw\">" + str + "</span>");
            };

            HtmlListener.prototype.invalid = function(str) {
              return show("<span class=\"dt\">" + str + "</span>");
            };

            HtmlListener.prototype.failure = function(str) {
              return show("<span class=\"al\">" + str + "</span>");
            };

            HtmlListener.prototype.done = function() {
              show('Completed test.');
              return resetProps();
            };

            return HtmlListener;

          })(ConsoleListener);
          Case.prototype.note = function(a) {
            this.noteArg(a);
            return a;
          };
          Case.prototype.noteVerbose = function(a) {
            this.noteArg(a);
            show(this.args);
            return a;
          };
          testPure = function(func, types, name, property) {
            return declare(name, types, function() {
              var a, c;
              c = arguments[0], a = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
              return c.assert(property.apply(null, [c].concat(__slice.call(a), [c.note(func.apply(null, a))])));
            });
          };
          qcConfig = new Config(100, 1000);
          test = function(msg, func) {
            return _.each([msg, func, runAllProps(qcConfig, new HtmlListener)], function(o) {
              if (!_.isUndefined(o)) return show(o);
            });
          };
          segments = (function() {
            var _i, _len, _ref, _results;
            _ref = document.getElementsByTagName('pre');
            _results = [];
            for (_i = 0, _len = _ref.length; _i < _len; _i++) {
              codeSegment = _ref[_i];
              if (codeSegment.className === 'sourceCode') {
                codeTag = codeSegment.getElementsByTagName('code')[0];
                if (codeTag === null || codeTag === void 0) {
                  codeTag = codeSegment.getElementsByTagName('textarea')[0];
                }
                if (codeTag.className === 'sourceCode coffeescript' || codeTag.className === 'sourceCode CoffeeScript') {
                  if (codeTag.value != null) {
                    segment = codeTag.value;
                  } else {
                    segment = codeTag.innerHTML;
                  }
                  code = segment.replace(/<br>/g, '\n');
                  code = code.replace(/<[^>]*>/g, '');
                  code = code.replace(/[&]gt;/g, '>');
                  code = code.replace(/[&]lt;/g, '<');
                  code = code.replace(/[&]nbsp;/g, ' ');
                  _results.push({
                    codeTag: codeTag,
                    code: code
                  });
                } else {
                  _results.push(void 0);
                }
              } else {
                _results.push(void 0);
              }
            }
            return _results;
          })();
          segments = (function() {
            var _i, _len, _results;
            _results = [];
            for (_i = 0, _len = segments.length; _i < _len; _i++) {
              segment = segments[_i];
              if (segment != null) _results.push(segment);
            }
            return _results;
          })();
          for (i = 0, _len = segments.length; i < _len; i++) {
            segment = segments[i];
            if (i > 0 && /^[\s]/.test(segment.code)) {
              segment.code = segments[i - 1].code + '\n' + segment.code;
              segments[i - 1] = void 0;
            }
          }
          segments = (function() {
            var _i, _len2, _results;
            _results = [];
            for (_i = 0, _len2 = segments.length; _i < _len2; _i++) {
              segment = segments[_i];
              if (segment != null) _results.push(segment);
            }
            return _results;
          })();
          for (incredibleindex = 0, _ref = segments.length; 0 <= _ref ? incredibleindex < _ref : incredibleindex > _ref; 0 <= _ref ? incredibleindex++ : incredibleindex--) {
            segment = segments[incredibleindex];
            codeTag = segment.codeTag;
            try {
              draw = void 0;
              eval(CoffeeScript.compile(segment.code, {
                bare: true
              }));
              if (draw != null) draw(window.ctx);
            } catch (error) {
              addErrorElement(error);
              return;
            }
          }
        };
        keyEvaluation = function(evt) {
          var _ref, _ref2;
          if ((evt != null ? evt.keyCode : void 0) === 13) {
            if (evt != null) if ((_ref = evt.target) != null) _ref.rows++;
          }
          if ((_ref2 = evt != null ? evt.keyCode : void 0) !== 16 && _ref2 !== 37 && _ref2 !== 38 && _ref2 !== 39 && _ref2 !== 40) {
            evaluateSource();
          }
        };
        cmEvaluation = function(editor, _arg) {
          var from, newText, next, to;
          from = _arg.from, to = _arg.to, newText = _arg.newText, next = _arg.next;
          editor.save();
          return evaluateSource();
        };
        createEditor = function(codeElement, text) {
          var c, countLines, elemCodeMirror, newelem;
          newelem = document.createElement('textarea');
          newelem.setAttribute('class', 'sourceCode coffeescript');
          countLines = ((function() {
            var _i, _len, _results;
            _results = [];
            for (_i = 0, _len = text.length; _i < _len; _i++) {
              c = text[_i];
              if (c === '\n') _results.push(c);
            }
            return _results;
          })()).length + 1;
          newelem.setAttribute('style', 'width: 98%;');
          newelem.setAttribute('rows', countLines);
          newelem.setAttribute('autofocus', 'true');
          newelem.setAttribute('spellcheck', 'false');
          newelem.innerHTML = text;
          newelem.addEventListener('keyup', keyEvaluation, false);
          getParent(codeElement).replaceChild(newelem, codeElement);
          if (this.useCodeMirror) {
            return elemCodeMirror = CodeMirror.fromTextArea(newelem, {
              onChange: cmEvaluation,
              lineNumbers: true,
              theme: 'pantheme'
            });
          }
        };
        activateEditor = function() {
          var sourcecode;
          this.removeEventListener('focus', activateEditor, false);
          sourcecode = this.innerHTML.toString().replace(/<\/?span[^>]*>/g, '');
          sourcecode = sourcecode.replace(/<br[ ]*[^>]*>/g, '\n');
          return createEditor(this, sourcecode);
        };
        _ref = document.getElementsByTagName('pre');
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          segment = _ref[_i];
          segment.getElementsByTagName('code')[0].addEventListener('focus', activateEditor, false);
        }
        return evaluateSource();
      };
      return window.ostrich = 'data:image/png;base64,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';
    }).call(this);</script>

